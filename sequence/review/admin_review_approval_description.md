## 필수 정보

### 1. 참여자 (Participants/Actors)
| 참여자 | 설명 | 기술 스택 |
|--------|------|-----------|
| 관리자 (Admin) | 시스템 관리자 | 브라우저 |
| 관리자 프론트엔드 (Admin Frontend) | 관리자 웹 클라이언트 | Next.js + Nginx |
| 백엔드 (Backend) | API 서버 | Spring + Spring Security |
| S3 | 이미지 저장소 | AWS S3 |
| DB (Database) | 데이터 저장소 | - |

### 2. 시나리오/흐름 설명
- 승인 대기 후기 목록 조회 프로세스
- 수료증 이미지 조회 프로세스
- 후기 승인 프로세스
- 후기 반려(삭제) 프로세스

> ※ 사용자의 후기 작성 흐름은 기존 review 시퀀스 참고
> ※ 사용자는 OCR 통과 후 바로 후기 작성 가능 (관리자 사후 검토 방식)
> ※ 관리자는 후기 내용을 확인하지 않고, 수료증 이미지만 확인하여 승인/반려 처리

### 3. 메시지 흐름 순서

#### 3-1. 승인 대기 후기 목록 조회 흐름
```
1. 관리자 → 관리자 프론트엔드: 후기 관리 메뉴 클릭
2. 관리자 프론트엔드 → 백엔드: 승인 대기 후기 목록 조회 (GET /api/admin/reviews?status=PENDING)
3. 백엔드 → DB: 승인 대기 상태 후기 목록 조회
4. DB → 백엔드: 후기 목록 반환 (작성자 정보, 강의 정보 포함)
5. 백엔드 → 관리자 프론트엔드: 200 OK (후기 목록 데이터)
6. 관리자 프론트엔드 → 관리자: 승인 대기 후기 목록 표시
```

#### 3-2. 수료증 이미지 조회 흐름
```
1. 관리자 → 관리자 프론트엔드: 수료증 확인 버튼 클릭
2. 관리자 프론트엔드 → 백엔드: 수료증 정보 조회 (GET /api/admin/reviews/{reviewId}/certificate)
3. 백엔드 → DB: 수료증 정보 조회
4. DB → 백엔드: 수료증 정보 반환 (강의명, 수료증 이미지 URL)
5. 백엔드 → 관리자 프론트엔드: 200 OK (수료증 데이터)
6. 관리자 프론트엔드 → S3: 수료증 이미지 요청 (이미지 URL)
7. S3 → 관리자 프론트엔드: 이미지 반환
8. 관리자 프론트엔드 → 관리자: 강의명 + 수료증 이미지 표시
```

#### 3-3. 후기 승인 흐름
```
1. 관리자 → 관리자 프론트엔드: "승인" 버튼 클릭
2. 관리자 프론트엔드 → 백엔드: 후기 승인 API 요청 (PATCH /api/admin/reviews/{reviewId}/approve)
3. 백엔드 → DB: 후기 승인 상태 업데이트 (approvalStatus: APPROVED)
4. DB → 백엔드: 업데이트 완료
5. 백엔드 → 관리자 프론트엔드: 200 OK (승인 완료)
6. 관리자 프론트엔드 → 관리자: 승인 완료 메시지 표시, 목록 새로고침
```

#### 3-4. 후기 반려(삭제) 흐름
```
1. 관리자 → 관리자 프론트엔드: "반려" 버튼 클릭
2. 관리자 프론트엔드 → 관리자: 반려 확인 모달 표시
3. 관리자 → 관리자 프론트엔드: 반려 확인
4. 관리자 프론트엔드 → 백엔드: 후기 반려 API 요청 (DELETE /api/admin/reviews/{reviewId})
5. 백엔드 → DB: 후기 삭제 (또는 상태를 REJECTED로 변경)
6. DB → 백엔드: 처리 완료
7. 백엔드 → 관리자 프론트엔드: 200 OK (반려 완료)
8. 관리자 프론트엔드 → 관리자: 반려 완료 메시지 표시, 목록 새로고침
```

---

## 선택 정보 (더 정교한 다이어그램을 위해)

### 4. 조건부 흐름 (alt/opt)
| 시나리오 | 분기 조건 |
|----------|-----------|
| 후기 승인/반려 | 없음 (단일 흐름) |

### 5. 반복 (loop)
- 없음

### 6. 병렬 처리 (par)
- 없음

### 7. 비동기 호출
- 모두 동기 호출

### 8. 노트/주석
- 사용자는 OCR 인증 통과 후 바로 후기 작성 가능 (사후 검토 방식)
- 관리자는 후기 내용을 확인하지 않고 수료증만 검증
- 후기는 관리자 승인 전까지 일반 사용자에게 미노출
- 수료증 이미지는 S3에 저장되어 있음 (review 시퀀스에서 저장)

---

## 추가 기술 정보

### 인증/인가 방식
| 항목 | 설명 |
|------|------|
| 후기 목록 조회 | 관리자 로그인 필수 |
| 수료증 조회 | 관리자 로그인 필수 |
| 후기 승인/반려 | 관리자 로그인 필수 |

### 후기 승인 상태
| 상태 | 설명 | 노출 여부 |
|------|------|----------|
| PENDING | 승인 대기 | 미노출 (본인에게만 노출 가능) |
| APPROVED | 승인 완료 | 노출 |
| REJECTED | 반려됨 | 미노출 (삭제 처리) |

### 검토 항목
| 항목 | 설명 |
|------|------|
| 수료증 확인 | 해당 강의의 정당한 수료증인지 확인 |

> ※ 관리자는 후기 내용을 확인하지 않음 (수료증만 검증)

### API 엔드포인트
| 기능 | Method | Endpoint | 설명 |
|------|--------|----------|---------|
| 후기 목록 조회 | GET | /api/admin/reviews | 상태별 필터링 가능 |
| 수료증 조회 | GET | /api/admin/reviews/{reviewId}/certificate | 강의명 + 수료증 URL |
| 후기 승인 | PATCH | /api/admin/reviews/{reviewId}/approve | 승인 처리 |
| 후기 반려 | DELETE | /api/admin/reviews/{reviewId} | 반려(삭제) 처리 |

### 에러 케이스
| HTTP Status | 설명 | 발생 조건 |
|-------------|------|-----------|
| 401 Unauthorized | 인증 필요 | 비로그인 또는 관리자 권한 없음 |
| 403 Forbidden | 권한 없음 | 관리자가 아닌 사용자가 접근 |
| 404 Not Found | 후기 없음 | 존재하지 않는 reviewId |
