## 필수 정보

### 1. 참여자 (Participants/Actors)
| 참여자 | 설명 | 기술 스택 |
|--------|------|-----------|
| 사용자 (User) | 서비스 이용자 | 브라우저 |
| 프론트엔드 (Frontend) | 웹 클라이언트 | Next.js + Nginx |
| 백엔드 (Backend) | API 서버 | Spring + Spring Security |
| DB (Database) | 데이터 저장소 | - |

### 2. 시나리오/흐름 설명
- LECTURE 스크랩 추가 프로세스
- LECTURE 스크랩 삭제 프로세스
- 스크랩 목록 조회 프로세스 (메인페이지 / 마이페이지)

### 3. 메시지 흐름 순서

#### 3-1. 스크랩 추가/삭제 흐름 (토글)

**접근 경로:**
- 강의 목록 페이지 → 스크랩 버튼 (하트 아이콘)
- 강의 상세 페이지 → 스크랩 버튼 (하트 아이콘)

```
1. 사용자 → 프론트엔드: 스크랩 버튼 클릭 (토글)
2. 프론트엔드 → 백엔드: 스크랩 토글 API 요청 (POST /api/wishlists/toggle?lectureId={id})
3. 백엔드 → DB: 기존 스크랩 여부 조회 (userId + lectureId)
4. DB → 백엔드: 조회 결과 반환
5. [조건] 스크랩 되어있지 않은 경우 (추가):
   - 백엔드 → DB: 현재 스크랩 개수 조회
   - DB → 백엔드: 스크랩 개수 반환
   - [조건] 스크랩 개수 < 10:
     - 백엔드 → DB: 스크랩 추가 (wishlist 테이블에 INSERT)
     - DB → 백엔드: 저장 완료
     - 백엔드 → 프론트엔드: 201 Created (스크랩 추가 성공)
     - 프론트엔드 → 사용자: 하트 아이콘 활성화 (채워진 하트)
   - [조건] 스크랩 개수 >= 10:
     - 백엔드 → 프론트엔드: 400 Bad Request (스크랩 개수 초과)
     - 프론트엔드 → 사용자: 알럿 표시 ("스크랩은 최대 10개까지 가능합니다")
6. [조건] 이미 스크랩된 경우 (삭제):
   - 백엔드 → DB: 스크랩 삭제 (wishlist 테이블에서 DELETE)
   - DB → 백엔드: 삭제 완료
   - 백엔드 → 프론트엔드: 200 OK (스크랩 삭제 성공)
   - 프론트엔드 → 사용자: 하트 아이콘 비활성화 (빈 하트)
```

#### 3-2. 스크랩 목록 조회 흐름 (메인페이지)
```
1. 사용자 → 프론트엔드: 메인페이지 접속
2. 프론트엔드 → 백엔드: 스크랩 목록 조회 API 요청 (GET /api/wishlists)
3. 백엔드 → DB: 스크랩 목록 조회 (userId, 스크랩 순서 정렬)
4. DB → 백엔드: 스크랩 목록 반환 (최대 10개)
5. 백엔드 → 프론트엔드: 200 OK (스크랩 목록 데이터)
6. 프론트엔드 → 사용자: 스크랩 목록 슬라이드로 표시
```

#### 3-3. 스크랩 목록 조회 흐름 (마이페이지)
```
1. 사용자 → 프론트엔드: 마이페이지 → "찜한 강의" 메뉴 클릭
2. 프론트엔드 → 백엔드: 스크랩 목록 조회 API 요청 (GET /api/wishlists)
3. 백엔드 → DB: 스크랩 목록 조회 (userId, 스크랩 순서 정렬)
4. DB → 백엔드: 스크랩 목록 반환 (최대 10개)
5. 백엔드 → 프론트엔드: 200 OK (스크랩 목록 데이터)
6. 프론트엔드 → 사용자: 스크랩 목록 전체 표시
```

---

## 선택 정보 (더 정교한 다이어그램을 위해)

### 4. 조건부 흐름 (alt/opt)
| 시나리오 | 분기 조건 |
|----------|-----------|
| 스크랩 토글 | 스크랩 추가 / 스크랩 삭제 |
| 스크랩 추가 | 개수 제한 미초과 / 개수 초과 (최대 10개) |
| 스크랩 목록 조회 | 없음 (단일 흐름) |

### 5. 반복 (loop)
- 없음

### 6. 병렬 처리 (par)
- 없음

### 7. 비동기 호출
- 모두 동기 호출

### 8. 노트/주석
- 스크랩 최대 개수: 10개
- 비로그인 시 스크랩 버튼 미표시 (UI 레벨에서 처리)

---

## 추가 기술 정보

### 인증/인가 방식
| 항목 | 설명 |
|------|------|
| 스크랩 추가/삭제 | 로그인 필수 |
| 스크랩 목록 조회 | 로그인 필수 |

### 데이터 관계
| 관계 | 설명 |
|------|------|
| User : Wishlist | 1 : N (유저당 최대 10개 스크랩) |
| Lecture : Wishlist | 1 : N (강의당 여러 유저가 스크랩 가능) |

### 스크랩 (Wishlist) 테이블
| 필드 | 설명 |
|------|------|
| id | PK |
| userId | 사용자 ID (FK) |
| lectureId | 강의 ID (FK) |
| createdAt | 스크랩 일시 |

### 스크랩 제한
| 항목 | 설명 |
|------|------|
| 최대 개수 | 10개 |
| 중복 스크랩 | 불가 (동일 강의 재스크랩 시 삭제 처리) |

### 정렬 기준
| 항목 | 설명 |
|------|------|
| 기본 정렬 | 스크랩한 순서 (createdAt DESC) |
| 추가 필터 | 추후 확장 가능 |

### API 엔드포인트
| 기능 | Method | Endpoint | 설명 |
|------|--------|----------|------|
| 스크랩 토글 | POST | /api/wishlists/toggle | lectureId로 스크랩 추가/삭제 |
| 스크랩 목록 조회 | GET | /api/wishlists | 로그인 사용자의 스크랩 목록 |

### 에러 케이스
| HTTP Status | 설명 | 발생 조건 |
|-------------|------|-----------|
| 400 Bad Request | 스크랩 개수 초과 | 10개 초과 시 스크랩 추가 시도 |
| 401 Unauthorized | 인증 필요 | 비로그인 상태에서 API 호출 |
| 404 Not Found | 강의 없음 | 존재하지 않는 lectureId로 스크랩 시도 |
