## 필수 정보

### 1. 참여자 (Participants/Actors)

| 참여자 | 설명 | 기술 스택 |
|--------|------|-----------|
| 사용자 (User) | 서비스 이용자 | 브라우저 |
| 관리자 (Admin) | 시스템 관리자 | 브라우저 |
| 프론트엔드 (Frontend) | 웹 클라이언트 | Next.js |
| 백엔드 (Backend) | API 서버 | Spring Boot |
| S3 | 이미지 저장소 | AWS S3 |
| DB (Database) | 데이터 저장소 | PostgreSQL |

### 2. 시나리오/흐름 설명

- 게시글 목록 조회 (필터링, 검색, 페이지네이션)
- 게시글 상세 조회 (조회수 증가)
- 게시글 작성 (이미지, 태그 첨부)
- 게시글 수정
- 게시글 삭제 (Soft Delete)
- 게시글 상단 고정 (관리자)

### 3. 메시지 흐름 순서

#### 3-1. 게시글 목록 조회

```
1. 사용자 → 프론트엔드: 게시판 페이지 접근
2. 프론트엔드 → 백엔드: GET /api/v1/posts (categoryId, tags, keyword, page)
3. 백엔드 → DB: 게시글 목록 조회 (JOIN: 작성자, 카테고리)
4. DB → 백엔드: 게시글 목록 반환
5. 백엔드 → DB: 댓글 수 일괄 조회 (N+1 방지)
6. DB → 백엔드: 댓글 수 반환
7. 백엔드 → 프론트엔드: Page<PostResponse>
8. 프론트엔드 → 사용자: 게시글 목록 표시
```

#### 3-2. 게시글 상세 조회

```
1. 사용자 → 프론트엔드: 게시글 클릭
2. 프론트엔드 → 백엔드: GET /api/v1/posts/{postId}
3. 백엔드 → DB: 게시글 조회
4. DB → 백엔드: 게시글 반환
5. 백엔드 → DB: 조회수 증가
6. [조건] 로그인 사용자:
   - 백엔드 → DB: 북마크 여부 조회
   - 백엔드 → DB: 좋아요 여부 조회
7. 백엔드 → 프론트엔드: PostDetailResponse
8. 프론트엔드 → 사용자: 게시글 상세 표시
```

#### 3-3. 게시글 작성

```
1. 사용자 → 프론트엔드: 글쓰기 버튼 클릭
2. [조건] 비로그인: 로그인 페이지로 이동
3. [조건] 닉네임 없음: 닉네임 설정 유도
4. 프론트엔드 → 사용자: 글쓰기 폼 표시
5. 사용자 → 프론트엔드: 게시글 작성 (제목, 본문, 이미지, 태그)
6. [선택] 이미지 첨부:
   - 프론트엔드 → S3: 이미지 업로드
   - S3 → 프론트엔드: 이미지 URL 반환
7. 프론트엔드 → 백엔드: POST /api/v1/posts
8. 백엔드 → DB: 게시글 저장
9. DB → 백엔드: 저장 완료
10. 백엔드 → 프론트엔드: 201 Created
11. 프론트엔드 → 사용자: 게시글 상세 페이지로 이동
```

#### 3-4. 게시글 수정

```
1. 사용자 → 프론트엔드: 수정 버튼 클릭
2. 프론트엔드 → 백엔드: GET /api/v1/posts/{postId}
3. 백엔드 → 프론트엔드: 게시글 데이터
4. 프론트엔드 → 사용자: 수정 폼 표시
5. 사용자 → 프론트엔드: 수정 내용 제출
6. 프론트엔드 → 백엔드: PUT /api/v1/posts/{postId}
7. 백엔드 → DB: 권한 확인 (본인 또는 관리자)
8. [조건] 권한 있음:
   - 백엔드 → DB: 게시글 수정
   - 백엔드 → 프론트엔드: 200 OK
9. [조건] 권한 없음:
   - 백엔드 → 프론트엔드: 403 Forbidden
```

#### 3-5. 게시글 삭제

```
1. 사용자 → 프론트엔드: 삭제 버튼 클릭
2. 프론트엔드 → 사용자: 삭제 확인 모달 표시
3. 사용자 → 프론트엔드: 삭제 확인
4. 프론트엔드 → 백엔드: DELETE /api/v1/posts/{postId}
5. 백엔드 → DB: 권한 확인 (본인 또는 관리자)
6. [조건] 권한 있음:
   - 백엔드 → DB: Soft Delete (deleted = true)
   - 백엔드 → 프론트엔드: 204 No Content
7. [조건] 권한 없음:
   - 백엔드 → 프론트엔드: 403 Forbidden
```

#### 3-6. 게시글 상단 고정 (관리자)

```
1. 관리자 → 프론트엔드: 고정 버튼 클릭
2. 프론트엔드 → 백엔드: POST /api/v1/posts/{postId}/pin (ADMIN 권한)
3. 백엔드 → DB: pinned 토글
4. DB → 백엔드: 수정 완료
5. 백엔드 → 프론트엔드: 200 OK (pinned: true/false)
6. 프론트엔드 → 관리자: 고정 상태 변경 표시
```

---

## 선택 정보

### 4. 조건부 흐름 (alt/opt)

| 시나리오 | 분기 조건 |
|----------|-----------|
| 게시글 작성 | 로그인 여부, 닉네임 설정 여부 |
| 게시글 수정/삭제 | 본인 또는 관리자 권한 |
| 상세 조회 | 로그인 시 북마크/좋아요 상태 조회 |

### 5. 기술 정보

| 항목 | 설명 |
|------|------|
| 인증 | JWT (HttpOnly Cookie) |
| 이미지 저장 | AWS S3 (Presigned URL) |
| 삭제 방식 | Soft Delete (deleted 플래그) |
| N+1 해결 | 댓글 수 일괄 조회 |

### 6. API 엔드포인트

| Method | Path | 설명 | 권한 |
|--------|------|------|------|
| GET | /api/v1/posts | 목록 조회 | 전체 |
| GET | /api/v1/posts/{postId} | 상세 조회 | 전체 |
| POST | /api/v1/posts | 작성 | USER |
| PUT | /api/v1/posts/{postId} | 수정 | 작성자/ADMIN |
| DELETE | /api/v1/posts/{postId} | 삭제 | 작성자/ADMIN |
| POST | /api/v1/posts/{postId}/pin | 고정 | ADMIN |
